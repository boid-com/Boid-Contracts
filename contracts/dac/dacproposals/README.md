# dacproposals
The eosdac worker proposal contract

Worker proposals are key to the running of a DAC.  The contract will facilitate the exchange of a product or service in return for a payment.

Proposals are generated by the worker seeking to perform the service in exchange for a payment.  Multiple worker proposals can be created for multi-milestone projects.

Requests can be generated by the DAC when a specific service is required, it will be entered into the database but will not have a specific account or payment attached.  Workers will tender for the job and will submit their own sub-proposal for each request.
## Tables
### Proposal

- type (int) - enum signifying if this is a proposal or request (REQUEST / PROPOSAL)
- id (uniqid) - A unique identifier assigned to the proposal when first saved, can be auto-incrementing
- worker (account_name / 0) - The account providing the service, will be 0 if type is REQUEST
- title (string) - A short description of the proposal (under 50 characters)
- Summary (string) - I think having a summary that can be displayed in the proposal list on the ui would be nice. Maybe around 300 char length
- desc (string) - A link to a document in IPFS, before IPFS is used we can make do with a url and hash of the content
- start (timestamp) - The commencement date of the proposal, can be in the past
- expire (timestamp) - The expiry data of the request / proposal.  Once this has passed it will no longer be eligible for custodian voting.
- due_date (timestamp) - Date after which no payments can be made.  Maybe payments after this date would need all 3 signatures to pass?
- arbitrator (account_name) - This will be an account which can be present in the 3 way signature in the claim action.  If the two parties in the worker proposal disagree on the deliverables then this account will be able to sign the claim action to release the funds or return them to the DAC.
- parent (uniqid) - If the type of the parent proposal is REQUEST then this is a tender proposal for that request.  If the parent type is PROPOSAL, then this is a child proposal and this proposal is a dependency of the parent proposal
- payment_amount - Amount of the payment for this proposal
- recurring - data used to specify if the schedule is recurring, could be used for regular workers.  Votes for this proposal will carry on and it will return to the unapproved stage in the period following completion.  So long as none of the custodians update their votes, this proposal will be approved on the following period.
- complete - Marks the proposal as completed, once 2/3 of the signatures are submitted (worker, DAC, arbitrator) then the payment will be sent to the worker

### ProposalVote

- proposal_id (uniqid) - The unique ID for the proposal being voted on
- voter (account_name) - The account name of the voter
- vote (enum) - yes, no, abstain
- comment (hash) - Pointer to ipfs hash with a json structure outlining various comments from the custodian

## Actions

### createprop

This allows a user to create a proposal.  To create a proposal a user must also lock a bond in eosDAC tokens.  This bond will be lost if the proposal is marked as spam (defined by a 100% no vote).  If no worker attribute is provided and the type is REQUEST then it will require a privileged account to create.

### voteprop 

Vote for a proposal, this can either be yes, no or abstain.  If a proposal receives 100% no votes then it will be classes as span / frivilous.  The account voting must be a currently elected custodian.

### newperiod 

Similar to the action run to tally custodian votes.  Proposals will be marked as accepted when their threshold passed the defined point.  It will perform the following actions;

Tally votes for each open proposal, it must verify that each vote was made by a currently elected custodian.  Votes made by unelected custodians for active proposals must not be removed, but will not be counted.  Voting data for unelected custodians can only be removed once the proposal has expired or been completed. 
Transfer proposal funds as available to the proposal contract from the DAC payment account.  The contract will keep track of all the accepted proposals and ensure that there are enough funds in the worker proposals account.

### claim 

Allows a worker to claim their pay, the DAC must have previously changed the status to complete.  If it is not marked as complete then it will fail.  We may also do this using a transaction proposal which has to be signed by both parties.

### cancel 

Cancel the proposal and return the funds to the DAC account, requires the same 2/3-party signature
